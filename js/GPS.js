// Generated by CoffeeScript 2.4.1
var GPS;

GPS = class GPS { // hanterar GPS konvertering
  constructor(nw, ne, se, sw, w, h) {
    this.nw = nw;
    this.ne = ne;
    this.se = se;
    this.sw = sw;
    this.w = w;
    this.h = h;
    print('constructor');
  }

  map_lon(mlat, mlon, a, b) {
    var lat, lon, x, y;
    x = map(mlon, a.lon, b.lon, a.x, b.x);
    y = map(mlon, a.lon, b.lon, a.y, b.y);
    lat = map(mlon, a.lon, b.lon, a.lat, b.lat);
    lon = mlon;
    return {lat, lon, x, y};
  }

  map_lat(mlat, mlon, a, b) {
    var lat, lon, x, y;
    x = map(mlat, a.lat, b.lat, a.x, b.x);
    y = map(mlat, a.lat, b.lat, a.y, b.y);
    lat = mlat;
    lon = map(mlat, a.lat, b.lat, a.lon, b.lon);
    return {lat, lon, x, y};
  }

  gps2bmp(mlat, mlon) {
    var q1, q2, x, y;
    q1 = this.map_lon(mlat, mlon, this.nw, this.ne);
    q2 = this.map_lon(mlat, mlon, this.sw, this.se);
    x = round(map(mlat, q1.lat, q2.lat, q1.x, q2.x));
    //x = round map mlon, q1.lon,q2.lon, q1.x,q2.x
    y = round(map(mlat, q1.lat, q2.lat, q1.y, q2.y));
    return [x, y];
  }

  assert_gps2bmp(p, error) {
    var x, y;
    [x, y] = this.gps2bmp(p.lat, p.lon);
    return assert(error, [x - p.x, y - p.y]);
  }

  map_x(x, y, a, b) {
    var lat, lon;
    lon = map(x, a.x, b.x, a.lon, b.lon);
    lat = map(x, a.x, b.x, a.lat, b.lat);
    return {lat, lon, x, y};
  }

  map_y(x, y, a, b) {
    var lat, lon;
    lon = map(y, a.y, b.y, a.lon, b.lon);
    lat = map(y, a.y, b.y, a.lat, b.lat);
    return {lat, lon, x, y};
  }

  bmp2gps(mx, my) {
    var q, q1, q2;
    q1 = this.map_x(mx, 0, this.nw, this.ne);
    q2 = this.map_x(mx, HEIGHT, this.sw, this.se);
    q = this.map_y(mx, my, q1, q2);
    return [myround(q.lat, 6), myround(q.lon, 6)];
  }

  assert_bmp2gps(p, error) {
    var lat, lon;
    [lat, lon] = this.bmp2gps(p.x, p.y);
    return assert(error, [myround(100000 * (lat - p.lat), 6), myround(50000 * (lon - p.lon), 6)]);
  }

};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiR1BTLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXEdQUy5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQU0sTUFBTixNQUFBLElBQUEsQ0FBQTtFQUNDLFdBQWMsR0FBQSxJQUFBLElBQUEsSUFBQSxHQUFBLEdBQUEsQ0FBQTtJQUFDLElBQUMsQ0FBQTtJQUFHLElBQUMsQ0FBQTtJQUFHLElBQUMsQ0FBQTtJQUFHLElBQUMsQ0FBQTtJQUFHLElBQUMsQ0FBQTtJQUFFLElBQUMsQ0FBQTtJQUNsQyxLQUFBLENBQU0sYUFBTjtFQURhOztFQUdkLE9BQVUsQ0FBQyxJQUFELEVBQU0sSUFBTixFQUFXLENBQVgsRUFBYSxDQUFiLENBQUE7QUFDVCxRQUFBLEdBQUEsRUFBQSxHQUFBLEVBQUEsQ0FBQSxFQUFBO0lBQUEsQ0FBQSxHQUFJLEdBQUEsQ0FBSSxJQUFKLEVBQVUsQ0FBQyxDQUFDLEdBQVosRUFBZ0IsQ0FBQyxDQUFDLEdBQWxCLEVBQXVCLENBQUMsQ0FBQyxDQUF6QixFQUEyQixDQUFDLENBQUMsQ0FBN0I7SUFDSixDQUFBLEdBQUksR0FBQSxDQUFJLElBQUosRUFBVSxDQUFDLENBQUMsR0FBWixFQUFnQixDQUFDLENBQUMsR0FBbEIsRUFBdUIsQ0FBQyxDQUFDLENBQXpCLEVBQTJCLENBQUMsQ0FBQyxDQUE3QjtJQUNKLEdBQUEsR0FBTSxHQUFBLENBQUksSUFBSixFQUFVLENBQUMsQ0FBQyxHQUFaLEVBQWdCLENBQUMsQ0FBQyxHQUFsQixFQUF1QixDQUFDLENBQUMsR0FBekIsRUFBNkIsQ0FBQyxDQUFDLEdBQS9CO0lBQ04sR0FBQSxHQUFNO1dBQ04sQ0FBQyxHQUFELEVBQUssR0FBTCxFQUFTLENBQVQsRUFBVyxDQUFYO0VBTFM7O0VBT1YsT0FBVSxDQUFDLElBQUQsRUFBTSxJQUFOLEVBQVcsQ0FBWCxFQUFhLENBQWIsQ0FBQTtBQUNULFFBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxDQUFB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OztBQTlDbEIiLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBHUFMgIyBoYW50ZXJhciBHUFMga29udmVydGVyaW5nXHJcblx0Y29uc3RydWN0b3IgOiAoQG53LEBuZSxAc2UsQHN3LEB3LEBoKSAtPlxyXG5cdFx0cHJpbnQgJ2NvbnN0cnVjdG9yJ1xyXG5cclxuXHRtYXBfbG9uIDogKG1sYXQsbWxvbixhLGIpIC0+XHJcblx0XHR4ID0gbWFwIG1sb24sIGEubG9uLGIubG9uLCBhLngsYi54XHJcblx0XHR5ID0gbWFwIG1sb24sIGEubG9uLGIubG9uLCBhLnksYi55IFxyXG5cdFx0bGF0ID0gbWFwIG1sb24sIGEubG9uLGIubG9uLCBhLmxhdCxiLmxhdFxyXG5cdFx0bG9uID0gbWxvblxyXG5cdFx0e2xhdCxsb24seCx5fSBcdFxyXG5cclxuXHRtYXBfbGF0IDogKG1sYXQsbWxvbixhLGIpIC0+XHJcblx0XHR4ID0gbWFwIG1sYXQsIGEubGF0LGIubGF0LCBhLngsYi54XHJcblx0XHR5ID0gbWFwIG1sYXQsIGEubGF0LGIubGF0LCBhLnksYi55XHJcblx0XHRsYXQgPSBtbGF0XHJcblx0XHRsb24gPSBtYXAgbWxhdCwgYS5sYXQsYi5sYXQsIGEubG9uLGIubG9uXHJcblx0XHR7bGF0LGxvbix4LHl9IFx0XHJcblxyXG5cdGdwczJibXAgOiAobWxhdCxtbG9uKSAtPlxyXG5cdFx0cTEgPSBAbWFwX2xvbiBtbGF0LG1sb24sQG53LEBuZVxyXG5cdFx0cTIgPSBAbWFwX2xvbiBtbGF0LG1sb24sQHN3LEBzZVxyXG5cdFx0eCA9IHJvdW5kIG1hcCBtbGF0LCBxMS5sYXQscTIubGF0LCBxMS54LHEyLnhcclxuXHRcdCN4ID0gcm91bmQgbWFwIG1sb24sIHExLmxvbixxMi5sb24sIHExLngscTIueFxyXG5cdFx0eSA9IHJvdW5kIG1hcCBtbGF0LCBxMS5sYXQscTIubGF0LCBxMS55LHEyLnlcclxuXHRcdFt4LHldXHJcblxyXG5cdGFzc2VydF9ncHMyYm1wIDogKHAsZXJyb3IpIC0+XHJcblx0XHRbeCx5XSA9IEBncHMyYm1wIHAubGF0LHAubG9uIFxyXG5cdFx0YXNzZXJ0IGVycm9yLCBbeC1wLngsIHktcC55XVxyXG5cclxuXHRtYXBfeCA6ICh4LHksYSxiKSAtPlxyXG5cdFx0bG9uID0gbWFwIHgsIGEueCxiLngsIGEubG9uLGIubG9uXHJcblx0XHRsYXQgPSBtYXAgeCwgYS54LGIueCwgYS5sYXQsYi5sYXQgIFxyXG5cdFx0e2xhdCxsb24seCx5fSBcdFxyXG5cclxuXHRtYXBfeSA6ICh4LHksYSxiKSAtPlxyXG5cdFx0bG9uID0gbWFwIHksIGEueSxiLnksIGEubG9uLGIubG9uXHJcblx0XHRsYXQgPSBtYXAgeSwgYS55LGIueSwgYS5sYXQsYi5sYXQgIFxyXG5cdFx0e2xhdCxsb24seCx5fSBcdFxyXG5cclxuXHRibXAyZ3BzIDogKG14LG15KSAtPlxyXG5cdFx0cTEgPSBAbWFwX3ggbXgsMCxAbncsQG5lXHJcblx0XHRxMiA9IEBtYXBfeCBteCxIRUlHSFQsQHN3LEBzZVxyXG5cdFx0cSA9IEBtYXBfeSBteCxteSxxMSxxMlxyXG5cdFx0W215cm91bmQocS5sYXQsNiksbXlyb3VuZChxLmxvbiw2KV1cclxuXHJcblx0YXNzZXJ0X2JtcDJncHMgOiAocCxlcnJvcikgLT5cclxuXHRcdFtsYXQsbG9uXSA9IEBibXAyZ3BzIHAueCxwLnkgXHJcblx0XHRhc3NlcnQgZXJyb3IsIFtteXJvdW5kKDEwMDAwMCoobGF0LXAubGF0KSw2KSwgbXlyb3VuZCg1MDAwMCoobG9uLXAubG9uKSw2KV1cclxuIl19
//# sourceURL=c:\github\gpsKarta\coffee\GPS.coffee