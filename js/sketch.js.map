{
  "version": 3,
  "file": "sketch.js",
  "sourceRoot": "..",
  "sources": [
    "coffee\\sketch.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "DELAY = 100 # ms, delay between sounds\r\nDIST = 1 # meter. Movement less than DIST makes no sound 1=walk. 5=bike\r\nLIMIT = 20 # meter. Under this, no bearing. Also distance voice every meter.\r\n\r\nDISTLIST = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,30,40,50,60,70,80,90,100,200,300,400,500,600,700,800,900,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000]\r\nMAIL = 'janchrister.nilsson@gmail.com'\r\n\r\nspara = (lat,lon, x,y) -> {lat,lon, x,y}\r\n\r\n# 2019-SommarN\r\n\r\n# A = spara 59.2987921, 18.1284073, 472, 617 # kontroll  5\r\n# B = spara 59.2985405, 18.1699098,4361, 503 # kontroll 10\r\n# C = spara 59.2851374, 18.1336592,1090,3104 # kontroll 31\r\n# D = spara 59.2844998, 18.1666946,4181,3069 # kontroll 17\r\n\r\n# FILENAME = '2019-SommarN.jpg' \r\n\r\n# controls = # id: [x,y,littera,lat,lon]\r\n# \t'1': [1830,333,'',0,0] \r\n# \t'2': [1506,521,'',0,0]\r\n# \t'3': [907,711,'',0,0]\r\n# \t'4': [1193,873,'',0,0]\r\n# \t'5': [472,617,'',0,0]\r\n# \t'6': [228,841,'',0,0]\r\n# \t'7': [672,1013,'',0,0]\r\n# \t'8': [1125,1196,'',0,0]\r\n# \t'9': [1430,1290,'',0,0]\r\n# \t'10': [4361,503,'',0,0]\r\n# \t'11': [4118,1106,'',0,0]\r\n# \t'12': [3830,640,'',0,0]\r\n# \t'13': [3192,1133,'',0,0]\r\n# \t'14': [2664,873,'',0,0]\r\n# \t'15': [2322,1862,'',0,0]\r\n# \t'16': [4120,2699,'',0,0]\r\n# \t'17': [4181,3069,'',0,0]\r\n# \t'19': [3340,2904,'',0,0]\r\n# \t'20': [2691,2554,'',0,0]\r\n# \t'24': [3366,3217,'',0,0]\r\n# \t'26': [390,1935,'',0,0]\r\n# \t'27': [547,2143,'',0,0]\r\n# \t'28': [1462,2293,'',0,0]\r\n# \t'29': [1055,2620,'',0,0]\r\n# \t'30': [371,2502,'',0,0]\r\n# \t'31': [1090,3104,'',0,0]\r\n# \t'32': [2250,2750,'',0,0]\r\n\r\n# 2019-SommarS\r\nA = spara 59.279157, 18.149313, 2599,676 # Mellanbron\r\nB = spara 59.275129, 18.169590, 4531,1328 # Ulvsjön Vändplan Huset\r\nC = spara 59.270072, 18.150229, 2763,2334 # Brotorpsbron\r\nD = spara 59.267894, 18.167087, 4339,2645 # Älta huset\r\n\r\nFILENAME = '2019-SommarS.jpg' \r\n\r\ncontrols = \r\n\t21: [4303,255,'',0,0]\r\n\t22: [4066,407,'',0,0]\r\n\t23: [3436,158,'',0,0]\r\n\t25: [3534,485,'',0,0]\r\n\t34: [1709,65,'',0,0]\r\n\t35: [1212,151,'',0,0]\r\n\t36: [2215,1008,'',0,0]\r\n\t37: [2571,1186,'',0,0]\r\n\t38: [2894,485,'',0,0]\r\n\t39: [3245,778,'',0,0]\r\n\t40: [4317,1003,'',0,0]\r\n\t41: [4303,685,'',0,0]\r\n\t42: [3868,1292,'',0,0]\r\n\t43: [3426,1281,'',0,0]\r\n\t44: [3536,1650,'',0,0]\r\n\t45: [4538,1763,'',0,0]\r\n\t46: [3926,2133,'',0,0]\r\n\t47: [3104,2025,'',0,0]\r\n\t48: [4256,2514,'',0,0]\r\n\t49: [3773,2493,'',0,0]\r\n\t50: [3231,2757,'',0,0]\r\n\r\n#################\r\n\r\ntargets = [] # [id, littera, distance]\r\nplatform = null\r\n\r\ninitControls = ->\r\n\tfor key,control of controls\r\n\t\t[x,y,littera] = control\r\n\t\t[lat,lon] = gps.bmp2gps x,y\r\n\t\tcontrol[3] = lat\r\n\t\tcontrol[4] = lon\r\n\r\nmakeTargets = ->\r\n\ttargets = []\r\n\tc = LatLon gpsLat, gpsLon \r\n\tfor key,control of controls\r\n\t\t[x,y,littera,lat,lon] = control\r\n\t\tb = LatLon lat, lon\r\n\t\ttargets.push [key, littera, round b.distanceTo(c)]\r\n\ttargets\r\n\r\nDATA = \"gpsKarta\"\r\nWIDTH = null\r\nHEIGHT = null\r\n[cx,cy] = [0,0] # center (image coordinates)\r\nSCALE = 1\r\n\r\ngps = null\r\nTRACKED = 5 # circles shows the player's position\r\nposition = null # gps position (pixels)\r\ntrack = [] # five latest GPS positions (pixels)\r\ntrail = [] # all gps points\r\ntakes = [] # all littera takes\r\n\r\nspeaker = null\r\n\r\nimg = null \r\nsoundUp = null\r\nsoundDown = null\r\nsoundQueue = 0 # neg=minskat avstånd pos=ökat avstånd\r\n\r\nmessages = [0,1,2,3,4,5]\r\ngpsCount = 0\r\n\r\n[gpsLat,gpsLon] = [0,0]\r\n[trgLat,trgLon] = [0,0]\r\ncurrentControl = \"1\"\r\n\r\ntimeout = null\r\n\r\nlastBearing = ''\r\nlastDistance = ''\r\n\r\nw = null\r\nh = null\r\nreleased = true \r\n\r\nsendMail = (subject,body) ->\r\n\ts = encodeURI \"mailto:#{MAIL}?subject=#{subject}&body=#{body}\"\r\n\t#print escape s\r\n\t#print encodeURI s  \r\n\t#print encodeURIComponent s \r\n\tmail.href = s\r\n\tmail.click()\r\n\r\nsay = (m) ->\r\n\tif speaker == null then return \r\n\tspeechSynthesis.cancel()\r\n\tspeaker.text = m\r\n\tspeechSynthesis.speak speaker\r\n\r\npreload = -> img = loadImage FILENAME\r\n\r\nmyround = (x,dec=6) ->\r\n\tx *= 10**dec\r\n\tx = Math.round x\r\n\tx/10**dec\r\n\r\n#show = (prompt,p) -> print prompt,\"http://maps.google.com/maps?q=#{p.lat},#{p.lon}\"\t\r\n\r\nvercal = (a,b,y) ->\r\n\tx = map y, a.y,b.y, a.x,b.x\r\n\tlat = map y, a.y,b.y, a.lat,b.lat\r\n\tlon = map y, a.y,b.y, a.lon,b.lon  \r\n\t{lat,lon,x,y} \t\r\n\r\nhortal = (a,b,x) ->\r\n\ty = map x, a.x,b.x, a.y,b.y\r\n\tlat = map x, a.x,b.x, a.lat,b.lat\r\n\tlon = map x, a.x,b.x, a.lon,b.lon  \r\n\t{lat,lon,x,y} \t\r\n\r\ncorner = (a,b,c,d,x,y)->\r\n\tlat = map y, c.y,d.y, c.lat,d.lat  \r\n\tlon = map x, a.x,b.x, a.lon,b.lon\r\n\t{lat,lon,x,y}\r\n\r\nmakeCorners = ->\r\n\r\n\tac0 = vercal A,C,0  \t                  # beräkna x\r\n\tac1 = vercal A,C,HEIGHT\r\n\tbd0 = vercal B,D,0\r\n\tbd1 = vercal B,D,HEIGHT\r\n\r\n\tab0 = hortal A,B,0                      # beräkna y\r\n\tab1 = hortal A,B,WIDTH\r\n\tcd0 = hortal C,D,0\r\n\tcd1 = hortal C,D,WIDTH\r\n\r\n\tnw = corner ac0,bd0,ab0,cd0, 0,    0\t\t# beräkna hörnen\r\n\tne = corner ac0,bd0,ab1,cd1, WIDTH,0\r\n\tse = corner ac1,bd1,ab1,cd1, WIDTH,HEIGHT\r\n\tsw = corner ac1,bd1,ab0,cd0, 0,    HEIGHT\r\n\r\n\tgps = new GPS nw,ne,se,sw,WIDTH,HEIGHT\r\n\r\n# coarse = (x) ->\r\n# \tn = Math.round(x).toString().length\r\n# \tmyround(x,1-n).toString()\r\n# assert '4000', coarse 3917.5\t\r\n# assert '400', coarse 421.2\t\r\n# assert '40', coarse 36.8\r\n# assert '5', coarse 5.4\r\n# assert '5', coarse 4.6\r\n\r\nsayDistance = (a,b) -> # a is newer\r\n\t# anropa say om någon gräns passeras\r\n\t# if a border is crossed, play a sound\r\n\tfor d in DISTLIST\r\n\t\tif (a-d) * (b-d) < 0\r\n\t\t\tdistance = if a >= LIMIT then 'distans ' + d else d\r\n\t\t\tsay distance\r\n\t\t\treturn\r\n\r\n# eventuellt kräva tio sekunder sedan föregående bäring sades\r\nsayBearing = (a,b) -> # a is newer\r\n\t# if a border is crossed, tell the new bearing\r\n\ta = Math.round a/10\r\n\tb = Math.round b/10\r\n\tif a != b # 0..35\r\n\t\tif a == 0 then a = 36\r\n\t\ttr = 'nolla ett tvåa trea fyra femma sexa sju åtta nia'.split ' '\r\n\t\tc = tr[a//10]\r\n\t\td = tr[a%%10]\r\n\t\tbearing = 'bäring ' + c + ' ' + d\r\n\t\tif bearing != lastBearing\r\n\t\t\tsay bearing\r\n\t\t\tlastbearing = bearing\r\n\r\nsoundIndicator = (p) ->\r\n\r\n\ttrail.push \"#{p.coords.latitude} #{p.coords.longitude} #{stdDateTime new Date()}\"\r\n\r\n\ta = LatLon p.coords.latitude,p.coords.longitude # newest\r\n\tb = LatLon gpsLat, gpsLon\r\n\tc = LatLon trgLat, trgLon # target\r\n\r\n\tdista = a.distanceTo c\r\n\tdistb = b.distanceTo c\r\n\tdistance = Math.round (dista - distb)/DIST\r\n\r\n\tsayDistance dista,distb\r\n\tbearinga = a.bearingTo c\r\n\tbearingb = b.bearingTo c\r\n\tif dista >= LIMIT then sayBearing bearinga,bearingb\r\n\r\n\tif abs(DIST * distance) < 10 \r\n\t\tmessages[3] = \"#{DIST * distance} m/s\" # abs dista-distb\r\n\telse\r\n\t\tmessages[3] = ''\r\n\r\n\tif distance != 0 # update only if DIST detected. Otherwise some beeps will be lost.\r\n\t\tgpsLat = p.coords.latitude\r\n\t\tgpsLon = p.coords.longitude\r\n\r\n\tif abs(distance) < 10 then soundQueue = distance # ett antal DIST\r\n\r\nplaySound = ->\r\n\tif soundQueue == 0 then return\r\n\tif soundQueue < 0 and soundDown != null\r\n\t\tsoundQueue++\r\n\t\tsoundDown.play()\r\n\telse if soundQueue > 0 and soundUp != null\r\n\t\tsoundQueue--\r\n\t\tsoundUp.play()\r\n\tmessages[4]\t= soundQueue\r\n\tif soundQueue==0 then xdraw()\r\n\r\nlocationUpdate = (p) ->\r\n\tgpsCount++\r\n\tmessages[5] = gpsCount\r\n\tsoundIndicator p\r\n\r\n\tposition = gps.gps2bmp gpsLat,gpsLon\r\n\r\n\ttrack.push position\r\n\tif track.length > TRACKED then track.shift()\r\n\txdraw()\r\n\tposition\r\n\r\nlocationUpdateFail = (error) ->\tif error.code == error.PERMISSION_DENIED then messages = ['Check location permissions']\r\n\r\ninitSpeaker = (index) ->\r\n\tsoundUp = loadSound 'soundUp.wav'\r\n\tsoundDown = loadSound 'soundDown.wav'\r\n\tsoundUp.setVolume 0.1\r\n\tsoundDown.setVolume 0.1\r\n\tclearInterval timeout\r\n\ttimeout = setInterval playSound, DELAY\r\n\tsoundQueue = 0\t\r\n\r\n\tspeaker = new SpeechSynthesisUtterance()\r\n\tvoices = speechSynthesis.getVoices()\r\n\tspeaker.voice = voices[index]\t\r\n\tspeaker.voiceURI = \"native\"\r\n\tspeaker.volume = 1\r\n\tspeaker.rate = 0.8\r\n\tspeaker.pitch = 0.8\r\n\tspeaker.text = ''\r\n\tspeaker.lang = 'sv-SE'\r\n\tdialogues.clear()\r\n\tsay \"speaker #{index}\"\r\n\r\nsetup = ->\r\n\r\n\tcanvas = createCanvas innerWidth-0.5, innerHeight-0.5\r\n\tcanvas.position 0,0 # hides text field used for clipboard copy.\r\n\r\n\tplatform = window.navigator.platform\r\n\r\n\tw = width/8\r\n\th = height/4 \r\n\tangleMode DEGREES\r\n\r\n\tWIDTH = img.width\r\n\tHEIGHT = img.height\r\n\r\n\tSCALE = 1\r\n\t[cx,cy] = [width,height]\r\n\t\r\n\tmakeCorners()\r\n\tsetTarget _.keys(controls)[0]\r\n\r\n\tx = width/2\r\n\ty = height/2\r\n\tx1 = 100\r\n\tx2 = width-100\r\n\ty1 = 100\r\n\ty2 = height-100\r\n\r\n\tinitControls()\r\n\r\n\tposition = [WIDTH/2,HEIGHT/2]\r\n\r\n\tnavigator.geolocation.watchPosition locationUpdate, locationUpdateFail,\r\n\t\tenableHighAccuracy: true\r\n\t\tmaximumAge: 30000\r\n\t\ttimeout: 27000\r\n\r\n\txdraw()\r\n\r\n\taddEventListener 'touchstart', (evt) ->\r\n\t\ttouches = evt.changedTouches\r\n\t\ttouch = touches[touches.length-1]\r\n\t\tmx = touch.pageX\r\n\t\tmy = touch.pageY\r\n\t\tmyMousePressed mx,my\r\n\r\ndrawTrack = ->\r\n\tpush()\r\n\tfc()\r\n\tsw 4\r\n\tsc 0 # BLACK\r\n\ttranslate width/2, height/2\r\n\tscale SCALE\r\n\tfor [x,y],i in track\r\n\t\tcircle x-cx, y-cy, 10 * (track.length-i)\r\n\tpop()\r\n\r\ndrawControl = ->\r\n\r\n\tlatLon2 = LatLon trgLat,trgLon\r\n\tlatLon1 = LatLon gpsLat,gpsLon\r\n\r\n\tbearing = latLon1.bearingTo latLon2\r\n\tmessages[0] = \"#{int bearing}º\"\r\n\tmessages[1] = currentControl\r\n\tmessages[2] = \"#{Math.round(latLon1.distanceTo latLon2)} m\"\r\n\r\n\tcontrol = controls[currentControl]\r\n\tx = control[0]\r\n\ty = control[1]\r\n\r\n\tpush()\r\n\tsc()\r\n\tfc 0,0,0,0.25\r\n\ttranslate width/2, height/2\r\n\tscale SCALE\r\n\tcircle x-cx, y-cy, 75\r\n\tpop()\r\n\r\nxdraw = ->\r\n\tbg 0,1,0\r\n\tfc()\r\n\timage img, 0,0, width,height, cx-width/SCALE/2, cy-height/SCALE/2, width/SCALE, height/SCALE\r\n\tdrawTrack()\r\n\tdrawControl()\r\n\ttextSize 100\r\n\tfc 0\r\n\tsc 1,1,0\r\n\tsw 3\r\n\tmargin = 25\r\n\tfor message,i in messages\r\n\t\ttextAlign [LEFT,CENTER,RIGHT][i%3], [TOP,BOTTOM][i//3]\r\n\t\ttext message, [margin,width/2,width-margin][i%3], [margin,height][i//3] \r\n\tshowDialogue()\r\n\r\nsetTarget = (key) ->\r\n\tif controls[currentControl] == null then return\r\n\tsoundQueue = 0\r\n\tcurrentControl = key\r\n\tcontrol = controls[currentControl]\r\n\tx = control[0]\r\n\ty = control[1]\r\n\t[trgLat,trgLon] = gps.bmp2gps x,y\t\r\n\r\nexecuteMail = -> # Sends the trail and all the takes\r\n\ts = takes.join \"\\n\"\r\n\ts += \"\\n\\n\"\r\n\ts += trail.join \"\\n\"\r\n\tsendMail \"Takes:#{takes.length} Trail:#{trail.length}\", s\r\n\ttakes = []\r\n\ttrail = []\r\n\r\n##########################\r\n\r\nArray.prototype.clear = -> @length = 0\r\nassert = (a, b, msg='Assert failure') -> chai.assert.deepEqual a, b, msg\r\n\r\nmenu1 = -> # Main Menu\r\n\tdialogue = new Dialogue() \r\n\tdialogue.add 'Target', -> menu3()\r\n\tdialogue.add 'PanZoom', -> menu2()\r\n\tdialogue.add 'Center', -> \r\n\t\t[cx,cy] = position\r\n\t\tdialogues.clear()\t\r\n\t\txdraw()\t\r\n\tdialogue.add 'Mail', -> executeMail()\r\n\tdialogue.add 'Speaker', -> initSpeaker 5\r\n\tdialogue.add 'Take', -> menu4()\r\n\tdialogue.clock ' ',true\r\n\r\nmenu2 = -> # Pan Zoom\r\n\tdialogue = new Dialogue()\r\n\tdialogue.add 'Up', -> cy -= 0.33*height/SCALE  \r\n\tdialogue.add ' ', -> # Not Used\r\n\tdialogue.add 'Right', -> cx += 0.33*width/SCALE\r\n\tdialogue.add 'Out', -> if SCALE > 0.5 then SCALE /= 1.5\r\n\tdialogue.add 'Down', -> cy += 0.33*height/SCALE\r\n\tdialogue.add 'In', -> SCALE *= 1.5\r\n\tdialogue.add 'Left', -> cx -= 0.33*width/SCALE\r\n\tdialogue.add 'Bike', -> \r\n\t\t[x,y] = gps.gps2bmp gpsLat,gpsLon\r\n\t\tcontrols['bike'] = [x,y,'',gpsLat,gpsLon]\r\n\t\tdialogues.clear()\r\n\tdialogue.clock()\r\n\r\nmenu3 = -> # Target\r\n\tdialogue = new Dialogue 0,0\r\n\ttargets = makeTargets()\r\n\tlst = targets.slice()\r\n\tlst = lst.sort (a,b) -> a[2] - b[2]\r\n\tdialogue.list lst, 8, false, (arr) ->\r\n\t\tif arr.length > 0 then setTarget arr[0]\r\n\t\tdialogues.clear()\t\t\r\n\r\nmenu4 = -> # Take\r\n\tdialogue = new Dialogue()\r\n\tdialogue.add 'ABCDE', -> menu5 'ABCDE'\r\n\tdialogue.add 'FGHIJ', -> menu5 'FGHIJ'\r\n\tdialogue.add 'KLMNO', -> menu5 'KLMNO'\r\n\tdialogue.add 'PQRST', -> menu5 'PQRST'\r\n\tdialogue.add 'UVWXYZ', -> menu5 'UVWXYZ'\r\n\tdialogue.clock()\r\n\r\naddZero = (n) -> if n <= 9 then \"0\" + n else n\r\n\r\nstdDateTime = (date) ->\r\n\ty = date.getFullYear()\r\n\tm = addZero date.getMonth() + 1\r\n\td = addZero date.getDate()\r\n\th = addZero date.getHours()\r\n\tM = addZero date.getMinutes()\r\n\ts =\taddZero date.getSeconds()\r\n\t\"#{y}-#{m}-#{d} #{h}:#{M}:#{s}\"\r\n\r\nupdate = (littera,index=2) ->\r\n\ttakes.push \"#{gpsLat} #{gpsLon} #{stdDateTime new Date()} #{currentControl} #{littera}\"\r\n\tcontrols[currentControl][index] = littera\r\n\tdialogues.clear()\r\n\r\nmenu5 = (letters) -> # ABCDE\r\n\tdialogue = new Dialogue() \r\n\tfor letter in letters\r\n\t\tdialogue.add letter, -> update @title\r\n\tdialogue.clock()\r\n\r\nshowDialogue = -> if dialogues.length > 0 then (_.last dialogues).show()\r\n\r\nmouseReleased = ->\r\n\treleased = true\r\n\tfalse\r\n\r\nmyMousePressed = (mx,my) -> \r\n\r\n\tif not released then return false\r\n\treleased = false \r\n\r\n\tif dialogues.length == 1 and dialogues[0].number == 0 then dialogues.pop() # dölj indikatorer\r\n\r\n\tdialogue = _.last dialogues\r\n\tif dialogues.length == 0 or not dialogue.execute mx,my \r\n\t\tif dialogues.length == 0 then menu1() else dialogues.pop()\r\n\t\txdraw()\r\n\t\treturn false\r\n\r\n\txdraw()\r\n\tfalse \r\n\r\nmousePressed = -> \r\n\tif platform == 'Win32' then myMousePressed mouseX,mouseY\r\n\tfalse\r\n"
  ]
}