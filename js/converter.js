// Generated by CoffeeScript 2.4.1
var Converter, b2w, bmp, myRound, w2b, wgs;

myRound = function(x, dec = 6) {
  return Math.round(x * 10 ** dec) / 10 ** dec;
};

Converter = class Converter { // between bmp and wgs
  constructor(inp, outp, decimals) {
    this.decimals = decimals;
    this.arr = this.solve(inp, outp);
  }

  convert(x, y) {
    var a, b, c, d, e, f;
    [a, b, c, d, e, f] = this.arr;
    return [myRound(a * x + b * y + c, this.decimals), myRound(d * x + e * y + f, this.decimals)];
  }

  solve(inp, outp) {
    var a, b, c, d, e, eqns, f;
    [a, b, c, d, e, f] = inp;
    eqns = [];
    eqns.push([a, b, 1, 0, 0, 0]);
    eqns.push([0, 0, 0, a, b, 1]);
    eqns.push([c, d, 1, 0, 0, 0]);
    eqns.push([0, 0, 0, c, d, 1]);
    eqns.push([e, f, 1, 0, 0, 0]);
    eqns.push([0, 0, 0, e, f, 1]);
    return this.gauss(eqns, outp);
  }

  // https://github.com/itsravenous/gaussian-elimination/blob/master/gauss.js
  gauss(A, x) {
    var c, i, index, j, k, l, len, len1, len2, len3, len4, len5, len6, len7, m, n, o, p, q, r, ref, ref1, ref2, ref3, ref4, ref5, ref6, ref7, res, s, t;
    n = A.length;
    ref = range(n);
    for (l = 0, len = ref.length; l < len; l++) {
      i = ref[l];
      A[i].push(x[i]);
    }
    ref1 = range(n);
    for (m = 0, len1 = ref1.length; m < len1; m++) {
      i = ref1[m];
      index = i;
      ref2 = range(i + 1, n);
      for (o = 0, len2 = ref2.length; o < len2; o++) {
        k = ref2[o];
        if (Math.abs(A[index][i] < Math.abs(A[k][i]))) {
          index = k;
        }
      }
      ref3 = range(i, n + 1);
      for (p = 0, len3 = ref3.length; p < len3; p++) {
        k = ref3[p];
        [A[index][k], A[i][k]] = [A[i][k], A[index][k]];
      }
      ref4 = range(i + 1, n);
      for (q = 0, len4 = ref4.length; q < len4; q++) {
        k = ref4[q];
        c = -A[k][i] / A[i][i];
        ref5 = range(i, n + 1);
        for (r = 0, len5 = ref5.length; r < len5; r++) {
          j = ref5[r];
          A[k][j] = i === j ? 0 : A[k][j] + c * A[i][j];
        }
      }
    }
    res = range(n).map(function() {
      return 0;
    });
    ref6 = range(n - 1, -1, -1);
    for (s = 0, len6 = ref6.length; s < len6; s++) {
      i = ref6[s];
      res[i] = A[i][n] / A[i][i];
      ref7 = range(i - 1, -1, -1);
      for (t = 0, len7 = ref7.length; t < len7; t++) {
        k = ref7[t];
        A[k][n] -= A[k][i] * res[i];
      }
    }
    return res;
  }

};

bmp = [
  338,
  1491,
  4299,
  1948,
  2963,
  5596 // x1,y1, x2,y2, x3,y3
];

wgs = [
  18.150709,
  59.285624,
  18.179902,
  59.283048,
  18.168739,
  59.269496 // lng1,lat1, lng2,lat2, lng3,lat3
];

b2w = new Converter(bmp, wgs, 6);

assert([wgs[0], wgs[1]], b2w.convert(bmp[0], bmp[1]));

assert([wgs[2], wgs[3]], b2w.convert(bmp[2], bmp[3]));

assert([wgs[4], wgs[5]], b2w.convert(bmp[4], bmp[5]));

w2b = new Converter(wgs, bmp, 0);

assert([bmp[0], bmp[1]], w2b.convert(wgs[0], wgs[1]));

assert([bmp[2], bmp[3]], w2b.convert(wgs[2], wgs[3]));

assert([bmp[4], bmp[5]], w2b.convert(wgs[4], wgs[5]));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udmVydGVyLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXGNvbnZlcnRlci5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsU0FBQSxFQUFBLEdBQUEsRUFBQSxHQUFBLEVBQUEsT0FBQSxFQUFBLEdBQUEsRUFBQTs7QUFBQSxPQUFBLEdBQVUsUUFBQSxDQUFDLENBQUQsRUFBRyxNQUFJLENBQVAsQ0FBQTtTQUFhLElBQUksQ0FBQyxLQUFMLENBQVcsQ0FBQSxHQUFFLEVBQUEsSUFBSSxHQUFqQixDQUFBLEdBQXNCLEVBQUEsSUFBSTtBQUF2Qzs7QUFFSixZQUFOLE1BQUEsVUFBQSxDQUFBO0VBQ0MsV0FBYyxDQUFDLEdBQUQsRUFBSyxJQUFMLFVBQUEsQ0FBQTtJQUFVLElBQUMsQ0FBQTtJQUFhLElBQUMsQ0FBQSxHQUFELEdBQU8sSUFBQyxDQUFBLEtBQUQsQ0FBTyxHQUFQLEVBQVcsSUFBWDtFQUEvQjs7RUFFZCxPQUFVLENBQUMsQ0FBRCxFQUFHLENBQUgsQ0FBQTtBQUNULFFBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQTtJQUFBLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxDQUFMLEVBQU8sQ0FBUCxFQUFTLENBQVQsRUFBVyxDQUFYLENBQUEsR0FBZ0IsSUFBQyxDQUFBO1dBQ2pCLENBQUMsT0FBQSxDQUFRLENBQUEsR0FBRSxDQUFGLEdBQUksQ0FBQSxHQUFFLENBQU4sR0FBUSxDQUFoQixFQUFrQixJQUFDLENBQUEsUUFBbkIsQ0FBRCxFQUErQixPQUFBLENBQVEsQ0FBQSxHQUFFLENBQUYsR0FBSSxDQUFBLEdBQUUsQ0FBTixHQUFRLENBQWhCLEVBQWtCLElBQUMsQ0FBQSxRQUFuQixDQUEvQjtFQUZTOztFQUlWLEtBQVEsQ0FBQyxHQUFELEVBQUssSUFBTCxDQUFBO0FBQ1AsUUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxD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QUFJLENBQUEsQ0FBQSxDQUFiLENBQVAsRUFBeUIsR0FBRyxDQUFDLE9BQUosQ0FBWSxHQUFJLENBQUEsQ0FBQSxDQUFoQixFQUFtQixHQUFJLENBQUEsQ0FBQSxDQUF2QixDQUF6Qjs7QUFDQSxNQUFBLENBQU8sQ0FBQyxHQUFJLENBQUEsQ0FBQSxDQUFMLEVBQVMsR0FBSSxDQUFBLENBQUEsQ0FBYixDQUFQLEVBQXlCLEdBQUcsQ0FBQyxPQUFKLENBQVksR0FBSSxDQUFBLENBQUEsQ0FBaEIsRUFBbUIsR0FBSSxDQUFBLENBQUEsQ0FBdkIsQ0FBekI7O0FBRUEsR0FBQSxHQUFNLElBQUksU0FBSixDQUFjLEdBQWQsRUFBa0IsR0FBbEIsRUFBc0IsQ0FBdEI7O0FBQ04sTUFBQSxDQUFPLENBQUMsR0FBSSxDQUFBLENBQUEsQ0FBTCxFQUFTLEdBQUksQ0FBQSxDQUFBLENBQWIsQ0FBUCxFQUF5QixHQUFHLENBQUMsT0FBSixDQUFZLEdBQUksQ0FBQSxDQUFBLENBQWhCLEVBQW1CLEdBQUksQ0FBQSxDQUFBLENBQXZCLENBQXpCOztBQUNBLE1BQUEsQ0FBTyxDQUFDLEdBQUksQ0FBQSxDQUFBLENBQUwsRUFBUyxHQUFJLENBQUEsQ0FBQSxDQUFiLENBQVAsRUFBeUIsR0FBRyxDQUFDLE9BQUosQ0FBWSxHQUFJLENBQUEsQ0FBQSxDQUFoQixFQUFtQixHQUFJLENBQUEsQ0FBQSxDQUF2QixDQUF6Qjs7QUFDQSxNQUFBLENBQU8sQ0FBQyxHQUFJLENBQUEsQ0FBQSxDQUFMLEVBQVMsR0FBSSxDQUFBLENBQUEsQ0FBYixDQUFQLEVBQXlCLEdBQUcsQ0FBQyxPQUFKLENBQVksR0FBSSxDQUFBLENBQUEsQ0FBaEIsRUFBbUIsR0FBSSxDQUFBLENBQUEsQ0FBdkIsQ0FBekIiLCJzb3VyY2VzQ29udGVudCI6WyJteVJvdW5kID0gKHgsZGVjPTYpIC0+IE1hdGgucm91bmQoeCoxMCoqZGVjKS8xMCoqZGVjXHJcblxyXG5jbGFzcyBDb252ZXJ0ZXIgIyBiZXR3ZWVuIGJtcCBhbmQgd2dzXHJcblx0Y29uc3RydWN0b3IgOiAoaW5wLG91dHAsQGRlY2ltYWxzKSAtPiBAYXJyID0gQHNvbHZlIGlucCxvdXRwXHJcblxyXG5cdGNvbnZlcnQgOiAoeCx5KSAtPlxyXG5cdFx0W2EsYixjLGQsZSxmXSA9IEBhcnJcclxuXHRcdFtteVJvdW5kKGEqeCtiKnkrYyxAZGVjaW1hbHMpLCBteVJvdW5kKGQqeCtlKnkrZixAZGVjaW1hbHMpXVxyXG5cclxuXHRzb2x2ZSA6IChpbnAsb3V0cCkgLT5cclxuXHRcdFthLGIsYyxkLGUsZl0gPSBpbnBcclxuXHRcdGVxbnMgPSBbXVxyXG5cdFx0ZXFucy5wdXNoIFthLCBiLCAxLCAwLCAwLCAwXVxyXG5cdFx0ZXFucy5wdXNoIFswLCAwLCAwLCBhLCBiLCAxXVxyXG5cdFx0ZXFucy5wdXNoIFtjLCBkLCAxLCAwLCAwLCAwXVxyXG5cdFx0ZXFucy5wdXNoIFswLCAwLCAwLCBjLCBkLCAxXVxyXG5cdFx0ZXFucy5wdXNoIFtlLCBmLCAxLCAwLCAwLCAwXVxyXG5cdFx0ZXFucy5wdXNoIFswLCAwLCAwLCBlLCBmLCAxXVxyXG5cdFx0QGdhdXNzIGVxbnMsb3V0cFxyXG5cclxuXHQjIGh0dHBzOi8vZ2l0aHViLmNvbS9pdHNyYXZlbm91cy9nYXVzc2lhbi1lbGltaW5hdGlvbi9ibG9iL21hc3Rlci9nYXVzcy5qc1xyXG5cdGdhdXNzIDogKEEsIHgpIC0+XHJcblx0XHRuID0gQS5sZW5ndGhcclxuXHRcdGZvciBpIGluIHJhbmdlIG5cclxuXHRcdFx0QVtpXS5wdXNoIHhbaV1cclxuXHJcblx0XHRmb3IgaSBpbiByYW5nZSBuXHJcblx0XHRcdGluZGV4ID0gaVxyXG5cdFx0XHRmb3IgayBpbiByYW5nZSBpKzEsIG5cclxuXHRcdFx0XHRpZiBNYXRoLmFicyBBW2luZGV4XVtpXSA8IE1hdGguYWJzIEFba11baV0gdGhlbiBpbmRleCA9IGtcclxuXHJcblx0XHRcdGZvciBrIGluIHJhbmdlIGksbisxXHJcblx0XHRcdFx0W0FbaW5kZXhdW2tdLCBBW2ldW2tdXSA9IFtBW2ldW2tdLCBBW2luZGV4XVtrXV1cclxuXHJcblx0XHRcdGZvciBrIGluIHJhbmdlIGkrMSwgblxyXG5cdFx0XHRcdGMgPSAtQVtrXVtpXSAvIEFbaV1baV1cclxuXHRcdFx0XHRmb3IgaiBpbiByYW5nZSBpLG4rMVxyXG5cdFx0XHRcdFx0QVtrXVtqXSA9IGlmIGk9PWogdGhlbiAwIGVsc2UgQVtrXVtqXSArIGMgKiBBW2ldW2pdXHJcblxyXG5cdFx0cmVzID0gcmFuZ2UobikubWFwIC0+IDBcclxuXHRcdGZvciBpIGluIHJhbmdlIG4tMSwgLTEsIC0xXHJcblx0XHRcdHJlc1tpXSA9IEFbaV1bbl0gLyBBW2ldW2ldXHJcblx0XHRcdGZvciBrIGluIHJhbmdlIGktMSwgLTEsIC0xXHJcblx0XHRcdFx0QVtrXVtuXSAtPSBBW2tdW2ldICogcmVzW2ldXHJcblxyXG5cdFx0cmVzXHJcblxyXG5ibXAgPSBbMzM4LDE0OTEsIDQyOTksMTk0OCwgMjk2Myw1NTk2XSAjIHgxLHkxLCB4Mix5MiwgeDMseTNcclxud2dzID0gWzE4LjE1MDcwOSw1OS4yODU2MjQsIDE4LjE3OTkwMiw1OS4yODMwNDgsIDE4LjE2ODczOSw1OS4yNjk0OTZdICMgbG5nMSxsYXQxLCBsbmcyLGxhdDIsIGxuZzMsbGF0M1xyXG5cclxuYjJ3ID0gbmV3IENvbnZlcnRlciBibXAsd2dzLDZcclxuYXNzZXJ0IFt3Z3NbMF0sIHdnc1sxXV0sIGIydy5jb252ZXJ0IGJtcFswXSxibXBbMV1cclxuYXNzZXJ0IFt3Z3NbMl0sIHdnc1szXV0sIGIydy5jb252ZXJ0IGJtcFsyXSxibXBbM11cclxuYXNzZXJ0IFt3Z3NbNF0sIHdnc1s1XV0sIGIydy5jb252ZXJ0IGJtcFs0XSxibXBbNV1cclxuXHJcbncyYiA9IG5ldyBDb252ZXJ0ZXIgd2dzLGJtcCwwXHJcbmFzc2VydCBbYm1wWzBdLCBibXBbMV1dLCB3MmIuY29udmVydCB3Z3NbMF0sd2dzWzFdXHJcbmFzc2VydCBbYm1wWzJdLCBibXBbM11dLCB3MmIuY29udmVydCB3Z3NbMl0sd2dzWzNdXHJcbmFzc2VydCBbYm1wWzRdLCBibXBbNV1dLCB3MmIuY29udmVydCB3Z3NbNF0sd2dzWzVdXHJcbiJdfQ==
//# sourceURL=c:\github\gpsKarta\coffee\converter.coffee